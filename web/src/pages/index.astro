---
import { Code } from 'astro:components';
import Layout from '@/layouts/Layout.astro';

import theme from '@/../../src/theme.js';

import CopyIcon from '@/icons/copy.astro';

const { animation } = theme;
---

<Layout title="TailwindCSS Animations">
  <wc-toast></wc-toast>
  <main class="pb-20">
    <header
      class="max-w-4xl mx-auto flex flex-col items-center justify-center py-10"
    >
      <h1 class="font-semibold text-4xl pt-10">TailwindCSS Animations</h1>
      <h2 class="font-medium opacity-70">The plugin that you need</h2>
      <div class="mt-10">
        <pre
          class="flex text-left text-xs">
          <Code wrap={true} code='npm install @mpondev/tailwindcss-animations' />
        </pre>
      </div>
    </header>

    <section class="max-w-4xl m-auto grid grid-cols-3 gap-4">
      {
        Object.keys(animation).map(animationKey => {
          return (
            <article
              class="animate-duration-1000 col-span-1 border rounded border-[#092635] hover:border-gray-600 hover:shadow transition cursor-crosshair relative"
              data-class={animationKey}
            >
              <div class="p-4 flex gap-4 items-center justify-center flex-col w-full h-full">
                <span class="w-16 h-16 bg-[#092635] rounded-md flex items-center justify-center" />
                <h3 class="font-semibold text-xs opacity-80">{animationKey}</h3>
              </div>
              <button
                class="absolute top-1 right-2"
                onclick={`navigator.clipboard.writeText('animate-${animationKey}'); alert('Class animate-${animationKey} copied to clipboard!');`}
              >
                <CopyIcon />
              </button>
            </article>
          );
        })
      }
    </section>
  </main>
</Layout>

<script>
  import theme from '@/../../src/theme.js';
  import { toast } from 'wc-toast';

  const $articles = document.querySelectorAll('article');

  $articles.forEach($article => {
    const animationKey = $article.getAttribute('data-class');
    const animationClass = `animate-${animationKey}`;
    const $box = $article.querySelector('span');

    if ($box == null) return;

    $article.addEventListener('mouseenter', () => {
      $box.classList.add(animationClass);
    });

    $article.addEventListener('mouseleave', () => {
      $box.classList.remove(animationClass);
    });

    $article.addEventListener('click', () => {
      const animationKey = $article.getAttribute('data-class');
      const CLASS_PREFIX = 'animate-';
      const ANIMATION_TO_COPY = CLASS_PREFIX + animationKey;

      navigator.clipboard.writeText(ANIMATION_TO_COPY);

      toast('Copied to clipboard!', {
        theme: {
          type: 'light',
        },
      });
    });
  });
</script>
